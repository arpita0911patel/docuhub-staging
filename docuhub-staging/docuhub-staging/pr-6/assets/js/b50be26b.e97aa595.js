"use strict";(self.webpackChunkciroh_docuhub=self.webpackChunkciroh_docuhub||[]).push([[7039],{54196:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"products/Data Management and Access Tools/dataaccess/index","title":"Data Access","description":"Input and Output of NWM","source":"@site/docs/products/Data Management and Access Tools/dataaccess/index.md","sourceDirName":"products/Data Management and Access Tools/dataaccess","slug":"/products/Data Management and Access Tools/dataaccess/","permalink":"/docs/products/Data Management and Access Tools/dataaccess/","draft":false,"unlisted":false,"editUrl":"https://github.com/CIROH-UA/ciroh-ua_website/edit/main/docs/products/Data Management and Access Tools/dataaccess/index.md","tags":[{"inline":true,"label":"NOMADS","permalink":"/docs/tags/nomads"},{"inline":true,"label":"NODD","permalink":"/docs/tags/nodd"},{"inline":true,"label":"Microsoft Planetary Computer","permalink":"/docs/tags/microsoft-planetary-computer"},{"inline":true,"label":"AWS Open data registry","permalink":"/docs/tags/aws-open-data-registry"},{"inline":true,"label":"ESRI","permalink":"/docs/tags/esri"}],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Data Access","description":"Input and Output of NWM","tags":["NOMADS","NODD","Microsoft Planetary Computer","AWS Open data registry","ESRI"]},"sidebar":"products","previous":{"title":"Data Management and Access Tools","permalink":"/docs/products/Data Management and Access Tools/"},"next":{"title":"nwmurl","permalink":"/docs/products/Data Management and Access Tools/dataaccess/NWMURL Library"}}');var r=n(74848),s=n(28453),o=n(99563);const i={sidebar_position:7,title:"Data Access",description:"Input and Output of NWM",tags:["NOMADS","NODD","Microsoft Planetary Computer","AWS Open data registry","ESRI"]},l="NWM Data Access",c={},d=[{value:"Input and Output Data of the National Water Model",id:"input-and-output-data-of-the-national-water-model",level:2},{value:"Official NOMADS Resource",id:"official-nomads-resource",level:3},{value:"NODD - NOAA Open Data Dissemination Program",id:"nodd---noaa-open-data-dissemination-program",level:3},{value:"AWS",id:"aws",level:4},{value:"Google \u2013 Operational NWM Data",id:"google--operational-nwm-data",level:4},{value:"Azure/Planetary Computer",id:"azureplanetary-computer",level:4},{value:"CIROH Resources",id:"ciroh-resources",level:3},{value:"Other resources",id:"other-resources",level:3},{value:"ESRI Living Atlas",id:"esri-living-atlas",level:4},{value:"Description of WRF-Hydro code:",id:"description-of-wrf-hydro-code",level:4}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"nwm-data-access",children:"NWM Data Access"})}),"\n",(0,r.jsx)(t.p,{children:'Within the CIROH projects, we encounter a wide range of data resources and data access inquiries. One of the most frequently asked questions is, "How can I obtain access to xyz-resource?". To help with answering that question, we have documented some of the most common data access methods and resources here, with links to additional sites to dive deeper.'}),"\n",(0,r.jsx)(t.h2,{id:"input-and-output-data-of-the-national-water-model",children:"Input and Output Data of the National Water Model"}),"\n",(0,r.jsx)(t.p,{children:"Here, you will find resources that grant access to the input data used and the output data produced by the operational national water model."}),"\n",(0,r.jsx)(t.h3,{id:"official-nomads-resource",children:"Official NOMADS Resource"}),"\n",(0,r.jsx)(t.p,{children:"The official NWM meteorological inputs and hydrology and routing outputs are accessible through both HTTP and FTP. These resources are provided by the National Center for Environmental Prediction (NCEP) at the following locations:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["NOMADS - NOAA Operational Model Archive and Distribution System","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://nomads.ncep.noaa.gov/pub/data/nccf/com/nwm",children:"HTTP"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"ftp://ftpprd.ncep.noaa.gov/pub/data/nccf/com/nwm",children:"FTP"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"As of October 24, 2023, these resources include the following directories:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"para_post-processed/    22-Sep-2023 20:37    -   \npost-processed/         02-Nov-2020 14:31    -   \nprod/                   24-Oct-2023 00:18    -   \nv3.0/                   24-Oct-2023 00:18    -  \n"})}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"para_post-processed"}),' directory lacks specific documentation, although the "para" designation suggests it is a "parallel" execution, indicating a candidate production run under testing for operational use. In the post-processed dataset, you will find the following subdirectories:']}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"https://nomads.ncep.noaa.gov/pub/data/nccf/com/nwm/post-processed/",children:"NOMADS post-processed"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"RFC: Outputs filtered down to RFC locations."}),"\n",(0,r.jsx)(t.li,{children:"WMS: Contains re-indexed/reformatted outputs in per-forecast netCDFs suitable for rapid querying and responsive for graph visualizations on the water.noaa.gov/map site."}),"\n",(0,r.jsx)(t.li,{children:"IMAGES: .png-formatted renderings of NWM output for various domains and variables."}),"\n",(0,r.jsx)(t.li,{children:"logs: Logs. :)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"nodd---noaa-open-data-dissemination-program",children:"NODD - NOAA Open Data Dissemination Program"}),"\n",(0,r.jsxs)(t.p,{children:['"The NOAA Open Data Dissemination (NODD) Program provides public access to NOAA\'s open data on commercial cloud platforms through public-private partnerships. These partnerships remove obstacles to public use of NOAA data, help avoid costs and risks associated with federal data access services, and leverage operational public-private partnerships with the cloud computing and information services industries."\n(For more information, visit ',(0,r.jsx)(t.a,{href:"https://www.noaa.gov/information-technology/open-data-dissemination",children:"NODD"}),")"]}),"\n",(0,r.jsxs)(t.p,{children:["The NODD datasets made available through several public cloud vendors are an incredible resource for accessing NWM data for research and evaluative purposes. The NWS NODD datasets are listed on ",(0,r.jsx)(t.a,{href:"https://www.noaa.gov/nodd/datasets",children:"this page"})," and include the following:"]}),"\n",(0,r.jsx)(t.h4,{id:"aws",children:"AWS"}),"\n",(0,r.jsx)(t.p,{children:"AWS hosts two repositories as part of their sustainability data initiative."}),"\n",(0,r.jsxs)(t.p,{children:["The first repository contains the operational data (now hosts 4 week rolling collection of all output; it used to only be short range and the registry entry retains the description only for the short_range data ",(0,r.jsx)(t.a,{href:"https://registry.opendata.aws/noaa-nwm-pds/",children:"here"}),"; alternatively, the same resource is described under the sustainability initiative page ",(0,r.jsx)(t.a,{href:"https://aws.amazon.com/marketplace/pp/prodview-73iwu7dcfuge2",children:"here"}),".)"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["The catalog of AWS-hosted operational NWM data can be browsed ",(0,r.jsx)(t.a,{href:"https://noaa-nwm-pds.s3.amazonaws.com/index.html",children:"here"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["The second (and more useful) AWS repository contains several versions of the retrospective dataset each described on the main page under the open data registry ",(0,r.jsx)(t.a,{href:"https://registry.opendata.aws/nwm-archive/",children:"here"}),".\n(The same information is also on the AWS sustainability initiative webpage ",(0,r.jsx)(t.a,{href:"https://aws.amazon.com/marketplace/pp/prodview-g6lcchc7brshwa",children:"here"})," )"]}),"\n",(0,r.jsx)(t.p,{children:"The different catalogs of those [currently] five versions of that resource are linked below:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Two versions of NWM v2.1 retrospective","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["netCDF, ",(0,r.jsx)(t.a,{href:"https://noaa-nwm-retrospective-2-1-pds.s3.amazonaws.com/index.html",children:"here"})]}),"\n",(0,r.jsxs)(t.li,{children:["zarr, ",(0,r.jsx)(t.a,{href:"https://noaa-nwm-retrospective-2-1-zarr-pds.s3.amazonaws.com/index.html",children:"here"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["Two versions of NWM v2.0 retrospective","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["netCDF, ",(0,r.jsx)(t.a,{href:"https://noaa-nwm-retro-v2-0-pds.s3.amazonaws.com/index.html",children:"here"})]}),"\n",(0,r.jsxs)(t.li,{children:["zarr, ",(0,r.jsx)(t.a,{href:"https://noaa-nwm-retro-v2-zarr-pds.s3.amazonaws.com/index.html",children:"here"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["NWM v1.2 retrospective data","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["netCDF, ",(0,r.jsx)(t.a,{href:"https://nwm-archive.s3.amazonaws.com/index.html",children:"here"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"The AWS retrospective resource is the primary publicly available source for the version 1.0 of the \u201cAORC\u201d Analysis of Record for Calibration dataset, which is a 40-year best-available estimate of most common meteorological parameters required for hydrological modeling. Version 1.1 of the dataset will accompany the release of the NWM model version 3.0 retrospective (or 2.2 version??), hopefully in the next few weeks."}),"\n",(0,r.jsxs)(t.p,{children:["Jupyter notebook instructions for processing NWM Zarr and NetCDF output formats ",(0,r.jsx)(t.a,{href:"https://github.com/CIROH-UA/data_access_example/",children:"here"})]}),"\n",(0,r.jsx)(t.p,{children:"An example of pulling data from the channel output zarr 2.1 archive and writing the results to csv follows:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-py",children:"'''\n#install these libraries if they aren't already installed\n!pip install zarr\n!pip install xarray\n!pip install s3fs\n!pip install numpy\n'''\n# Import needed libraries\n\nimport xarray as xr\nimport numpy as np\nimport s3fs\nfrom datetime import datetime, timedelta\n\n# open the zarr store\nurl = \"s3://noaa-nwm-retrospective-2-1-zarr-pds/chrtout.zarr\"\nfs = s3fs.S3FileSystem(anon=True)\nstore = xr.open_zarr(s3fs.S3Map(url, s3=fs))\n\n# Function to get the time series for a specified reach id and and time range\n# then write it out to a csv file.\ndef GetAndWriteTimeSeriesAtReach(reach_id, start_time_index, end_time_index):\n    flows = streamflow_array.where(feature_id_array==reach_id, drop=True)\n    df_flows = flows[start_time_index:end_time_index].to_dataframe()\n    df_flows.to_csv(f'flows_{reach_id}.csv')\n\n# get an xarray array of the various values\ntime_array = store['time']\nfeature_id_array = store['feature_id']\nstreamflow_array = store['streamflow']\n\n# Define the feature IDs to check for\nfeature_ids = [5781221, 5781223, 5781703]\n\n# Specify the start and end times of interest\nstart_time = datetime(2015, 5, 23, 0, 0, 0)\nend_time = datetime(2015, 6, 24, 0, 0, 0)\n\n# Get the indices for the needed dates\nzero_start_time = start_date = datetime(1979, 2, 1, 0, 0, 0)\nstart_time_index = int((start_time - zero_start_time).total_seconds() / 3600)\nend_time_index = int((end_time - zero_start_time).total_seconds() / 3600)\n\nfor reach_id in feature_ids:\n    GetAndWriteTimeSeriesAtReach(reach_id, start_time_index, end_time_index)\n\n'''\nSimple Script for Retrieving Retrospective NWM Data from AWS Store\nDan Ames, 11/17/2023\ndan.ames@byu.edu\n'''\n\n"})}),"\n",(0,r.jsx)(t.h4,{id:"google--operational-nwm-data",children:"Google \u2013 Operational NWM Data"}),"\n",(0,r.jsxs)(t.p,{children:["Google hosts the most complete operational data archive of inputs and outputs from the National Water Model, with nearly every file since August 2018. The Google open data registry provides additional explanations ",(0,r.jsx)(t.a,{href:"https://console.cloud.google.com/marketplace/product/noaa-public/national-water-model?project=explore-ai-387703",children:"here"}),"."]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Operational data can be browsed ",(0,r.jsx)(t.a,{href:"https://console.cloud.google.com/storage/browser/national-water-model",children:"here"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Google also hosts a copy of the NWM v1.2 retrospective ",(0,r.jsx)(t.a,{href:"https://console.cloud.google.com/storage/browser/national-water-model-reanalysis",children:"here"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Coming soon: Big Query"}),"\n",(0,r.jsx)(t.p,{children:"Efforts are underway to make some of the datasets from the NWM operational and retrospective simulations available on BigQuery for ultra-high-bandwidth access. Stay tuned..."}),"\n",(0,r.jsx)(t.h4,{id:"azureplanetary-computer",children:"Azure/Planetary Computer"}),"\n",(0,r.jsxs)(t.p,{children:["Microsoft hosts the NWM input and output datasets in Azure Blob Storage, associated with the Microsoft Planetary Computer.\n",(0,r.jsx)(t.a,{href:"https://planetarycomputer.microsoft.com/dataset/storage/noaa-nwm",children:"Microsoft Planetary Computer"}),"\nTom Augspurger of Microsoft has a series of notebooks providing examples of how to use this data from his workshop at the first CIROH developers conference.\n",(0,r.jsx)(t.a,{href:"https://github.com/TomAugspurger/noaa-nwm",children:"Tom Augspurger's Notebooks"})]}),"\n",(0,r.jsx)(t.h3,{id:"ciroh-resources",children:"CIROH Resources"}),"\n",(0,r.jsx)(t.p,{children:"More detailed information and example usage will be available soon."}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Kerchunk Retro (points to AWS 2.1 NetCDF Retro)","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"https://ciroh-nwm-zarr-retrospective-data-copy.s3.amazonaws.com/index.html",children:"Kerchunk Retro"})," - Forcing complete; model output 2011-2020"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["Kerchunk Operational (points to Google assets \u2013 a simple text change can point to AWS short range, if desired)","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://ciroh-nwm-zarr-copy.s3.amazonaws.com/index.html",children:"Kerchunk Operational"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"other-resources",children:"Other resources"}),"\n",(0,r.jsx)(t.h4,{id:"esri-living-atlas",children:"ESRI Living Atlas"}),"\n",(0,r.jsxs)(t.p,{children:["ESRI Living Atlas provides a map-enabled version of the NWM output, which can be accessed ",(0,r.jsx)(t.a,{href:"https://www.esri.com/arcgis-blog/products/analytics/analytics/esri-visualizes-noaas-national-water-model/",children:"here"}),"."]}),"\n",(0,r.jsx)(t.h4,{id:"description-of-wrf-hydro-code",children:"Description of WRF-Hydro code:"}),"\n",(0,r.jsxs)(t.p,{children:["A detailed description of various aspects of the WRF-Hydro code, which produces the current NWM, can be found ",(0,r.jsx)(t.a,{href:"https://ral.ucar.edu/sites/default/files/public/projects/wrf_hydro/technical-description-user-guide/wrf-hydro-v5.1.1-technical-description.pdf",children:"here"}),"."]}),"\n",(0,r.jsx)(t.hr,{}),"\n","\n",(0,r.jsx)(o.A,{})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},99563:(e,t,n)=>{n.d(t,{A:()=>w});n(96540);var a=n(34164),r=n(93751),s=n(56289),o=n(81430),i=n(22887),l=n(50539),c=n(9303);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var h=n(74848);function p(e){let{href:t,children:n}=e;return(0,h.jsx)(s.A,{href:t,className:(0,a.A)("card padding--lg",d.cardContainer),children:n})}function u(e){let{href:t,icon:n,title:r,description:s}=e;return(0,h.jsxs)(p,{href:t,children:[(0,h.jsxs)(c.A,{as:"h2",className:(0,a.A)("text--truncate",d.cardTitle),title:r,children:[n," ",r]}),s&&(0,h.jsx)("p",{className:(0,a.A)("text--truncate",d.cardDescription),title:s,children:s})]})}function m(e){let{item:t}=e;const n=(0,r.Nr)(t),a=function(){const{selectMessage:e}=(0,o.W)();return t=>e(t,(0,l.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:t}))}();return n?(0,h.jsx)(u,{href:n,icon:"\ud83d\uddc3\ufe0f",title:t.label,description:t.description??a(t.items.length)}):null}function f(e){let{item:t}=e;const n=(0,i.A)(t.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",a=(0,r.cC)(t.docId??void 0);return(0,h.jsx)(u,{href:t.href,icon:n,title:t.label,description:t.description??a?.description})}function x(e){let{item:t}=e;switch(t.type){case"link":return(0,h.jsx)(f,{item:t});case"category":return(0,h.jsx)(m,{item:t});default:throw new Error(`unknown item type ${JSON.stringify(t)}`)}}function g(e){let{className:t}=e;const n=(0,r.$S)();return(0,h.jsx)(w,{items:n.items,className:t})}function w(e){const{items:t,className:n}=e;if(!t)return(0,h.jsx)(g,{...e});const s=(0,r.d1)(t);return(0,h.jsx)("section",{className:(0,a.A)("row",n),children:s.map(((e,t)=>(0,h.jsx)("article",{className:"col col--6 margin-bottom--lg",children:(0,h.jsx)(x,{item:e})},t)))})}},81430:(e,t,n)=>{n.d(t,{W:()=>c});var a=n(96540),r=n(40797);const s=["zero","one","two","few","many","other"];function o(e){return s.filter((t=>e.includes(t)))}const i={locale:"en",pluralForms:o(["one","other"]),select:e=>1===e?"one":"other"};function l(){const{i18n:{currentLocale:e}}=(0,r.A)();return(0,a.useMemo)((()=>{try{return function(e){const t=new Intl.PluralRules(e);return{locale:e,pluralForms:o(t.resolvedOptions().pluralCategories),select:e=>t.select(e)}}(e)}catch(t){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${t.message}\n`),i}}),[e])}function c(){const e=l();return{selectMessage:(t,n)=>function(e,t,n){const a=e.split("|");if(1===a.length)return a[0];a.length>n.pluralForms.length&&console.error(`For locale=${n.locale}, a maximum of ${n.pluralForms.length} plural forms are expected (${n.pluralForms.join(",")}), but the message contains ${a.length}: ${e}`);const r=n.select(t),s=n.pluralForms.indexOf(r);return a[Math.min(s,a.length-1)]}(n,t,e)}}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var a=n(96540);const r={},s=a.createContext(r);function o(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);